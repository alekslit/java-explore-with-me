# ExploreWithMe

### Технологический стек:

1. Java 11;
2. Spring Boot;
3. Apache Maven;
4. Lombok;
5. PostgreSQL;
6. Docker;
7. Postman;
8. Hibernate.

## _Описание проекта._
       
Backend часть приложения ExploreWithMe (англ. _"исследуй со мной"_).  

Приложение помогает пользователям делиться информацией об интересных событиях и находить компанию для участия в них. 
Оно делает проще планирование своего досуга: поиск информации о событии, переговоры с другими участниками. Проще говоря 
приложение является аналогом "афиши", в которой можно предложить какое-либо событие от выставки до похода в кино и 
собрать компанию для участия в нём.  

Относительно уровня доступа, приложение условно поделено на три части: приватную, публичную и административную. В 
соответствии с этим, в зависимости от уровня доступа (пользователь, гость, модератор) доступны те или инные функции 
приложения, и действия с сущностями.

Также есть разделение приложения на модули: два микросервиса. Основной отвечает за работу с пользователями - main 
service. Второй отвечает за сбор статистики просмотров - stats service.

### Ключевой функционал приложения:

Пользователь создаёт событие, другие пользователи могут послать запрос на участие в нём. Далее инициатор мероприятия 
может принять или отклонить запрос на участие. Модератор имеет возможность создавать подборки событий для главной 
страницы. Есть возможность комментировать события, а также отправить жалобу на комментарии содержащие нарушения.

## _Как запустить?_

1. Требуется ПК с Unix подобной ОС: Mac OS, Linux (например Ubuntu). Для остальных ОС требуется поднять виртуальную 
   машину (например с помощью VirtualBox, WSL) с одной из Unix подобных ОС.
2. Установить Docker на ПК;
3. Клонировать репозиторий на свой ПК;
4. Сойдать jar файлы из модулей проекта, например через Intellij IDEA с помощью команды mvn package (при повторной 
   пересборке рекомендуется использовать чистую сборку: mvn clean package);
5. Запустить приложение через терминал, из папки проекта, командой docker-compose up

## _ER-диаграммы БД проекта._

### Схема БД основного сервиса (main-service)

![ER-diagram main service.](explore_with_me_db/main_service_db.png)

### Схема БД сервиса статистики (stats-service)

![ER-diagram stats service.](explore_with_me_db/stats_service_db.png)

## _Описание БД проекта._

### main-service

1. Таблица `users`. Содержит данные о пользователях приложения.
   * _**user_id**_ (первичный ключ) - идентификатор пользователя;
   * _**name**_ - имя пользователя;
   * _**email**_ - электронная почта пользователя.
2. Таблица `categories`. Содержит информацию о категориях события.
   * _**category_id**_ (первичный ключ) - идентификатор категории;
   * _**name**_ - название события.
3. Таблица `events`. Содержит информацию о событии.
   * _**event_id**_ (первичный ключ) - идентификатор события;
   * _**annotation**_ - краткое описание события;
   * _**confirmed_requests**_ - количество одобренных заявок на участие в событии;
   * _**creation_date**_ - дата и время создания события;
   * _**description**_ - полное описание события;
   * _**event_date**_ - дата и время на которые намечено событие;
   * _**location_lat**_ - широта места проведения события;
   * _**location_lon**_ - долгота места проведения события;
   * _**paid**_ - нужно ли оплачивать участие в событии;
   * _**participant_limit**_ - ограничение на количество участников;
   * _**published_date**_ - дата и время публикации события;
   * _**request_moderation**_ - нужна ли пре-модерация заявок на участие;
   * _**event_status**_ - состояние события;
   * _**title**_ - заголов события;
   * _**views**_ - количество просмотров события пользователями;
   * _**available**_ - доступность для участия;
   * _**comments_count**_ - количество уникальных комментариев у события;
   * _**user_id**_ (внешний ключ) - идентификатор пользователя, автора события;
   * _**category_id**_ (внешний ключ) - идентификатор категории события.
4. Таблица `participation_requests`. Содержит данные о запросах на участие в событии от других пользователей.
   * _**request_id**_ (первичный ключ) - идентификатор запроса;
   * _**event_id**_ (внешний ключ) - идентификатор события, на которое оформлен запрос;
   * _**request_status**_ - статус заявки;
   * _**creation_date**_ - дата и время создания запроса;
   * _**user_id**_ (внешний ключ) - идентификатор пользователя, автора запроса.
5. Таблица `compilations`. Содержит информацию о подборках событий.
   * _**compilation_id**_ - идентификатор подборки;
   * _**pinned**_ - закреплена ли подборка на главной странице сайта;
   * _**title**_ - заголовок подборки.
6. Таблица `event_compilations`. Обеспечивает связь многие ко многим между событиями и подборками событий.
   * _**event_id**_ (внешний ключ) - идентификатор события, которое входит в подборку;
   * _**compilation_id**_ (внешний ключ) - идентификатор подборки, в которую входит событие.
7. Таблица `comments`. Содержит данные о комментариях пользователей к событиям.
   * _**comment_id**_ - идентификатор комментария;
   * _**event_id**_ (внешний ключ) - идентификатор события, к которому написан комментарий;
   * _**text**_ - текст комментария;
   * _**user_id**_ (внешний ключ) - идентификатор пользователя, автора комментария;
   * _**creation_date**_ - дата и время создания комментария.
8. Таблица `complaints`. Содержит данные о жалобах пользователей на комментарии.
   * _**complaint_id**_ - идентификатор жалобы;
   * _**comment_id**_ (внешний ключ) - идентификатор комментария, на который отправлена жалоба;
   * _**reason**_ - причина жалобы;
   * _**creation_date**_ - дата и время создания жалобы;
   * _**user_id**_ (внешний ключ) - идентификатор пользователя, автора жалобы.

### stats-service

1. Таблица `stats`. Содержит информацию для анализа посещений пользователя.
   * _**stat_id**_ (первичный ключ) - идентификтор статистической записи;
   * _**app**_ - название сервиса который посетил пользователь;
   * _**uri**_ - URI адрес по которому перешёл пользователь;
   * _**ip**_ - IP пользователя;
   * _**creation_date**_ - дата и время посещения сервиса пользователем.