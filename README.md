# ExploreWithMe

### Технологический стек:

1. Java 11;
2. Spring Boot;
3. Apache Maven;
4. Lombok;
5. PostgreSQL;
6. Docker;
7. Postman;
8. Hibernate.

## _Описание проекта._
       
Backend часть приложения ExploreWithMe (англ. _"исследуй со мной"_).  

Приложение помогает пользователям делиться информацией об интересных событиях и находить компанию для участия в них. 
Оно делает проще планирование своего досуга: поиск информации о событии, переговоры с другими участниками. Проще говоря 
приложение является аналогом "афиши", в которой можно предложить какое-либо событие от выставки до похода в кино и 
собрать компанию для участия в нём.  

Относительно уровня доступа, приложение условно поделено на три части: приватную, публичную и административную. В 
соответствии с этим, в зависимости от уровня доступа (пользователь, гость, модератор) доступны те или инные функции 
приложения, и действия с сущностями.

Также есть разделение приложения на модули: два микросервиса. Основной отвечает за работу с пользователями - main 
service. Второй отвечает за сбор статистики просмотров - stats service.

### Ключевой функционал приложения:

Пользователь создаёт событие, другие пользователи могут послать запрос на участие в нём. Далее инициатор мероприятия 
может принять или отклонить запрос на участие. Модератор имеет возможность создавать подборки событий для главной 
страницы. Есть возможность комментировать события, а также отправить жалобу на комментарии содержащие нарушения.

## _Как запустить?_

1. Требуется ПК с Unix подобной ОС: Mac OS, Linux (например Ubuntu). Для остальных ОС требуется поднять виртуальную 
   машину (например с помощью VirtualBox, WSL) с одной из Unix подобных ОС.
2. Установить Docker на ПК;
3. Клонировать репозиторий на свой ПК;
4. Сойдать jar файлы из модулей проекта, например через Intellij IDEA с помощью команды mvn package (при повторной 
   пересборке рекомендуется использовать чистую сборку: mvn clean package);
5. Запустить приложение через терминал, из папки проекта, командой docker-compose up

## _ER-диаграммы БД проекта._

### Схема БД основного сервиса (main-service)

![ER-diagram main service.](explore_with_me_db/main_service_db.png)

### Схема БД сервиса статистики (stats-service)

![ER-diagram stats service.](explore_with_me_db/stats_service_db.png)

## _Описание БД проекта._

### main-service

1. Таблица `users`. Содержит данные о пользователях приложения.
   * _user_id_ (первичный ключ) - идентификатор пользователя;
   * _name_ - имя пользователя;
   * _email_ - электронная почта пользователя.
2. Таблица `categories`. Содержит информацию о категориях события.
   * _category_id_ (первичный ключ) - идентификатор категории;
   * _name_ - название события.
3. Таблица `events`. Содержит информацию о событии.
   * _event_id_ (первичный ключ) - идентификатор события;
   * _annotation_ - краткое описание события;
   * _confirmed_requests_ - количество одобренных заявок на участие в событии;
   * _creation_date_ - дата и время создания события;
   * _description_ - полное описание события;
   * _event_date_ - дата и время на которые намечено событие;
   * _location_lat_ - широта места проведения события;
   * _location_lon_ - долгота места проведения события;
   * _paid_ - нужно ли оплачивать участие в событии;
   * _participant_limit_ - ограничение на количество участников;
   * _published_date_ - дата и время публикации события;
   * _request_moderation_ - нужна ли пре-модерация заявок на участие;
   * _event_status_ - состояние события;
   * _title_ - заголов события;
   * _views_ - количество просмотров события пользователями;
   * _available_ - доступность для участия;
   * _comments_count_ - количество уникальных комментариев у события;
   * _user_id_ (внешний ключ) - идентификатор пользователя, автора события;
   * _category_id_ (внешний ключ) - идентификатор категории события.
4. Таблица `participation_requests`. Содержит данные о запросах на участие в событии от других пользователей.
   * _request_id_ (первичный ключ) - идентификатор запроса;
   * _event_id_ (внешний ключ) - идентификатор события, на которое оформлен запрос;
   * _request_status_ - статус заявки;
   * _creation_date_ - дата и время создания запроса;
   * _user_id_ (внешний ключ) - идентификатор пользователя, автора запроса.
5. Таблица `compilations`. Содержит информацию о подборках событий.
   * _compilation_id_ - идентификатор подборки;
   * _pinned_ - закреплена ли подборка на главной странице сайта;
   * _title_ - заголовок подборки.
6. Таблица `event_compilations`. Обеспечивает связь многие ко многим между событиями и подборками событий.
   * _event_id_ (внешний ключ) - идентификатор события, которое входит в подборку;
   * _compilation_id_ (внешний ключ) - идентификатор подборки, в которую входит событие.
7. Таблица `comments`. Содержит данные о комментариях пользователей к событиям.
   * _comment_id_ - идентификатор комментария;
   * _event_id_ (внешний ключ) - идентификатор события, к которому написан комментарий;
   * _text_ - текст комментария;
   * _user_id_ (внешний ключ) - идентификатор пользователя, автора комментария;
   * _creation_date_ - дата и время создания комментария.
8. Таблица `complaints`. Содержит данные о жалобах пользователей на комментарии.
   * _complaint_id_ - идентификатор жалобы;
   * _comment_id_ (внешний ключ) - идентификатор комментария, на который отправлена жалоба;
   * _reason_ - причина жалобы;
   * _creation_date_ - дата и время создания жалобы;
   * _user_id_ (внешний ключ) - идентификатор пользователя, автора жалобы.

### stats-service

1. Таблица `stats`. Содержит информацию для анализа посещений пользователя.
   * _stat_id_ (первичный ключ) - идентификтор статистической записи;
   * _app_ - название сервиса который посетил пользователь;
   * _uri_ - URI адрес по которому перешёл пользователь;
   * _ip_ - IP пользователя;
   * _creation_date_ - дата и время посещения сервиса пользователем.